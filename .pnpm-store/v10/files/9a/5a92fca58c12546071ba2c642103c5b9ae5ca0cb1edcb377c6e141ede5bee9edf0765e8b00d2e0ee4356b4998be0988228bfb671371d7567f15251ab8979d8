{"version":3,"sources":["../src/server/index.ts","../src/server/createRootServer.ts","../src/server/format.ts"],"sourcesContent":["import { createRootServer } from './createRootServer.ts'\n\nexport { createRootServer } from './createRootServer.ts'\nexport type * from './types.ts'\n\nexport default createRootServer\n","import { ReactTemplate } from '../shared/ReactTemplate.tsx'\nimport { createNode } from '../shared/dom.ts'\nimport { format } from './format.ts'\n\nimport type { Logger } from '@kubb/core/logger'\nimport type { RootContextProps } from '../components/Root.tsx'\nimport type { DOMElement } from '../types.ts'\nimport type { RootType } from './types.ts'\n\nconst instances = new Map<string, ReactTemplate>()\n\ntype Props = {\n  container?: DOMElement\n  logger?: Logger\n}\n\nexport function createRootServer<Context extends RootContextProps = RootContextProps>({ container, logger }: Props): RootType<Context> {\n  if (!container) {\n    container = createNode('kubb-root')\n  }\n\n  const instance = new ReactTemplate<Context>(container, { logger })\n  instances.set(instance.id, instance)\n\n  return {\n    renderToString(children, context?: Context) {\n      instance.render(children, context)\n      return format(instance.output)\n    },\n    unmount() {\n      instance.unmount()\n      instances.delete(instance.id)\n    },\n    get files() {\n      return instance.files\n    },\n    getFile(id: string) {\n      return instance.files.find((file) => file.id === id)\n    },\n  }\n}\n","import { format as prettierFormat } from 'prettier'\nimport pluginTypescript from 'prettier/plugins/typescript'\n\nimport type { Options } from 'prettier'\n\nconst formatOptions: Options = {\n  tabWidth: 2,\n  printWidth: 160,\n  parser: 'typescript',\n  singleQuote: true,\n  semi: false,\n  bracketSameLine: false,\n  endOfLine: 'auto',\n  plugins: [pluginTypescript],\n}\nexport function format(source?: string): Promise<string> {\n  if (!source) {\n    return Promise.resolve('')\n  }\n  return prettierFormat(source, formatOptions)\n}\n"],"mappings":";;;;;;;;;AAAA;;;ACAA;;;ACAA;AAAA,SAAS,UAAU,sBAAsB;AACzC,OAAO,sBAAsB;AAI7B,IAAM,gBAAyB;AAAA,EAC7B,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR,aAAa;AAAA,EACb,MAAM;AAAA,EACN,iBAAiB;AAAA,EACjB,WAAW;AAAA,EACX,SAAS,CAAC,gBAAgB;AAC5B;AACO,SAAS,OAAO,QAAkC;AACvD,MAAI,CAAC,QAAQ;AACX,WAAO,QAAQ,QAAQ,EAAE;AAAA,EAC3B;AACA,SAAO,eAAe,QAAQ,aAAa;AAC7C;;;ADXA,IAAM,YAAY,oBAAI,IAA2B;AAO1C,SAAS,iBAAsE,EAAE,WAAW,OAAO,GAA6B;AACrI,MAAI,CAAC,WAAW;AACd,gBAAY,WAAW,WAAW;AAAA,EACpC;AAEA,QAAM,WAAW,IAAI,cAAuB,WAAW,EAAE,OAAO,CAAC;AACjE,YAAU,IAAI,SAAS,IAAI,QAAQ;AAEnC,SAAO;AAAA,IACL,eAAe,UAAU,SAAmB;AAC1C,eAAS,OAAO,UAAU,OAAO;AACjC,aAAO,OAAO,SAAS,MAAM;AAAA,IAC/B;AAAA,IACA,UAAU;AACR,eAAS,QAAQ;AACjB,gBAAU,OAAO,SAAS,EAAE;AAAA,IAC9B;AAAA,IACA,IAAI,QAAQ;AACV,aAAO,SAAS;AAAA,IAClB;AAAA,IACA,QAAQ,IAAY;AAClB,aAAO,SAAS,MAAM,KAAK,CAAC,SAAS,KAAK,OAAO,EAAE;AAAA,IACrD;AAAA,EACF;AACF;;;ADnCA,IAAO,iBAAQ;","names":[]}